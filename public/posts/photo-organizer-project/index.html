<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=mobile-web-app-capable content="yes"><meta name=viewport content="width=device-width,initial-scale=1,initial-scale=1,shrink-to-fit=no"><title>Photo Organizer and Deduplicator | M -- O --- R .-. C -.-. E . codes</title><link rel=icon type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=128x128 href=/favicon-128x128.png><link rel=icon type=image/png sizes=256x256 href=/favicon-256x256.png><link rel=icon type=image/webp sizes=16x16 href=/favicon-16x16.webp><link rel=icon type=image/webp sizes=32x32 href=/favicon-32x32.webp><link rel=icon type=image/webp sizes=64x64 href=/favicon-64x64.webp><link rel=icon type=image/webp sizes=256x256 href=/favicon-256x256.webp><link rel=apple-touch-icon sizes=180x180 href=/favicon-256x256.png><link rel=stylesheet href=/css/vars.css><link rel=stylesheet href=/css/syntax.css><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/nav.css><link rel=stylesheet href=/css/custom.css></head><body><header><nav class=navbar><a href=/ class=logo-link><img src=/MORCE.webp alt="M -- O --- R .-. C -.-. E . codes" class=logo>
</a><label for=dropdown><svg height="20" fill="currentColor" viewBox="0 0 640 640"><title>Menu</title><path d="M96 160c0-17.7 14.3-32 32-32H512c17.7.0 32 14.3 32 32s-14.3 32-32 32H128c-17.7.0-32-14.3-32-32zm0 160c0-17.7 14.3-32 32-32H512c17.7.0 32 14.3 32 32s-14.3 32-32 32H128c-17.7.0-32-14.3-32-32zM544 480c0 17.7-14.3 32-32 32H128c-17.7.0-32-14.3-32-32s14.3-32 32-32H512c17.7.0 32 14.3 32 32z"/></svg>
</label><input type=checkbox id=dropdown checked><ul><li><a href=/>Home</a></li><li><a aria-current=page class=active href=/posts/>Posts</a></li><li><a href=/tags/>Tags</a></li></ul></nav></header><main><h1>Photo Organizer and Deduplicator</h1><div class=metadata><time datetime=2025-12-01T14:23:59-06:00>December 1, 2025</time>
&mdash;<ul class=tags><li><a href=/tags/synology>#synology</a></li><li><a href=/tags/dsm>#dsm</a></li><li><a href=/tags/photo-management>#photo-management</a></li><li><a href=/tags/automation>#automation</a></li><li><a href=/tags/python>#python</a></li><li><a href=/tags/package>#package</a></li></ul></div><h1 id=dsm-7-package>DSM 7 Package
<a href=#dsm-7-package class=anchor>#</a></h1><figure style="text-align:center;margin:1em 0"><img src=/images/icon_256.png alt="Photo Organizer Icon" style=width:256px;height:256px;max-width:256px></figure><h2 id=table-of-contents>Table of Contents
<a href=#table-of-contents class=anchor>#</a></h2><ol><li><a href=#overview>Overview</a></li><li><a href=#purpose>Purpose</a></li><li><a href=#key-features>Key Features</a></li><li><a href=#package-details>Package Details</a></li><li><a href=#github-repository>GitHub Repository</a></li><li><a href=#download>Download</a></li><li><a href=#how-it-works>How It Works</a></li><li><a href=#file-processing-logic>File Processing Logic</a></li><li><a href=#duplicate-handling>Duplicate Handling</a></li><li><a href=#statistics-tracking>Statistics Tracking</a></li><li><a href=#logging>Logging</a></li><li><a href=#synology-integration>Synology Integration</a></li><li><a href=#license>License</a></li><li><a href=#support>Support</a></li></ol><h2 id=overview>Overview
<a href=#overview class=anchor>#</a></h2><p>Photo Organizer and Deduplicator is a Synology NAS package that automatically organizes and manages your photo collection. This intelligent application continuously monitors a designated folder and automatically sorts photos by their capture date, detects duplicates, and organizes your entire photo library with minimal user intervention.</p><h2 id=purpose>Purpose
<a href=#purpose class=anchor>#</a></h2><p>The Photo Organizer script is designed to solve common photo management challenges:</p><ul><li><strong>Automatic Organization</strong>: Automatically sorts photos into year-based folders based on when they were taken</li><li><strong>Duplicate Detection</strong>: Identifies and handles both exact duplicates and visually similar images</li><li><strong>Continuous Monitoring</strong>: Watches a source folder and processes new photos as they arrive</li><li><strong>Smart File Naming</strong>: Renames files to a consistent <code>yyyymmdd_hhmmss.*</code> format for easy organization</li><li><strong>EXIF Metadata Support</strong>: Uses photo metadata when available, with intelligent fallbacks</li></ul><h2 id=key-features>Key Features
<a href=#key-features class=anchor>#</a></h2><h3 id=automatic-folder-monitoring>Automatic Folder Monitoring
<a href=#automatic-folder-monitoring class=anchor>#</a></h3><p>The application continuously watches a user-defined source directory (<code>Photos/PhotosToProcess</code> by default) and automatically processes new files as they are added.</p><h3 id=intelligent-date-detection>Intelligent Date Detection
<a href=#intelligent-date-detection class=anchor>#</a></h3><ul><li><strong>Primary Method</strong>: Extracts date from EXIF metadata (<code>DateTimeOriginal</code>) when available<ul><li>Checks top-level EXIF tags first</li><li>Searches nested EXIF data (ExifIFD) for cameras that store metadata in nested structures</li><li>Falls back to <code>DateTimeDigitized</code> if <code>DateTimeOriginal</code> is unavailable</li><li>Handles various EXIF storage formats for maximum compatibility</li></ul></li><li><strong>Fallback Method</strong>: Uses file creation or modification date if EXIF data is missing</li><li><strong>Smart Organization</strong>: Files are organized into year-based subfolders (e.g., <code>Photos/2024/</code>)</li></ul><h3 id=duplicate-detection>Duplicate Detection
<a href=#duplicate-detection class=anchor>#</a></h3><ul><li><strong>Exact Duplicates</strong>: Uses MD5 hash comparison to identify identical files</li><li><strong>Similar Images</strong>: Employs perceptual hashing to detect visually similar images</li><li><strong>Quality Comparison</strong>: When duplicates are found, compares image quality (resolution, file size, color depth) and keeps the best version</li><li><strong>Smart Handling</strong>:<ul><li>Exact duplicates are moved to a <code>Duplicates</code> folder with unique naming</li><li>Similar images are saved with <code>_A</code>, <code>_B</code>, etc. suffixes in the main Photos folder</li></ul></li></ul><h3 id=file-renaming>File Renaming
<a href=#file-renaming class=anchor>#</a></h3><p>Files with date information are automatically renamed to <code>yyyymmdd_hhmmss.*</code> format, making it easy to find and organize photos chronologically.</p><h2 id=package-details>Package Details
<a href=#package-details class=anchor>#</a></h2><h3 id=package-information>Package Information
<a href=#package-information class=anchor>#</a></h3><ul><li><strong>Package Name</strong>: PhotoOrganizer</li><li><strong>Version</strong>: 1.0.1-0012</li><li><strong>Display Name</strong>: Photo Organizer and Deduplicator</li><li><strong>Architecture</strong>: noarch (works on all Synology NAS models)</li><li><strong>Minimum DSM Version</strong>: 7.0-40000</li><li><strong>Maintainer</strong>: MORCE.codes</li><li><strong>Type</strong>: Third-party package</li></ul><h3 id=technical-requirements>Technical Requirements
<a href=#technical-requirements class=anchor>#</a></h3><ul><li><strong>Python</strong>: 3.7 or higher</li><li><strong>Dependencies</strong>:<ul><li><a href=https://python-pillow.org/ target=_blank rel="noopener noreferrer">Pillow</a> - For reading EXIF data and image processing</li><li><a href=https://python-watchdog.readthedocs.io/ target=_blank rel="noopener noreferrer">watchdog</a> - For folder monitoring</li><li><a href=https://github.com/JohannesBuchner/imagehash target=_blank rel="noopener noreferrer">imagehash</a> - For perceptual hashing (similar image detection)</li><li>hashlib - Built-in Python library for MD5 hash calculation</li></ul></li></ul><h3 id=installation>Installation
<a href=#installation class=anchor>#</a></h3><ol><li>Download the <code>.spk</code> file (see download link below)</li><li>Open Synology Package Center</li><li>Click &ldquo;Manual Install&rdquo; and select the downloaded <code>.spk</code> file</li><li>Follow the installation wizard</li><li>Configure the source and destination directories during setup</li></ol><h3 id=usage>Usage
<a href=#usage class=anchor>#</a></h3><p>Once installed, the service runs automatically in the background:</p><ol><li>Place photos in the configured source directory (default: <code>Photos/PhotosToProcess</code>)</li><li>The service automatically processes existing photos</li><li>New photos added to the folder are automatically organized</li><li>Photos are sorted into year-based folders with consistent naming</li><li>Duplicates are detected and handled according to the configured settings</li></ol><h2 id=github-repository>GitHub Repository
<a href=#github-repository class=anchor>#</a></h2><p><a href=https://github.com/52454D434F/DSM-Projects target=_blank rel="noopener noreferrer">View on GitHub</a></p><p>The project source code, build scripts, and documentation are available on GitHub. Contributions, bug reports, and feature requests are welcome!</p><h2 id=download>Download
<a href=#download class=anchor>#</a></h2><h3 id=latest-version-101-0012>Latest Version: 1.0.1-0012
<a href=#latest-version-101-0012 class=anchor>#</a></h3><p><a href=/downloads/PhotoOrganizer-1.0.1-0012.spk>Download PhotoOrganizer-1.0.1-0012.spk</a></p><h2 id=how-it-works>How It Works
<a href=#how-it-works class=anchor>#</a></h2><ol><li><strong>Monitoring</strong>: The service uses a file system watcher to detect new files in the source directory</li><li><strong>Processing</strong>: When a new photo is detected:<ul><li>EXIF metadata is extracted to determine the capture date</li><li>If EXIF data is unavailable, file timestamps are used</li><li>The photo is checked against existing files for duplicates</li><li>Image quality is compared if duplicates are found</li></ul></li><li><strong>Organization</strong>: Photos are moved to appropriate year-based folders and renamed consistently</li><li><strong>Duplicate Handling</strong>: Exact duplicates are moved to a dedicated folder, while similar images are preserved with unique suffixes</li></ol><h2 id=file-processing-logic>File Processing Logic
<a href=#file-processing-logic class=anchor>#</a></h2><p>The Photo Organizer uses a sophisticated multi-step process to handle each file that appears in the source directory.</p><h3 id=processing-workflow>Processing Workflow
<a href=#processing-workflow class=anchor>#</a></h3><ol><li><p><strong>File Detection</strong>: The system waits 0.5 seconds after detecting a new file to ensure it&rsquo;s fully written (important for large files being copied)</p></li><li><p><strong>File Type Detection</strong>: Determines if the file is an image or video based on file extension</p></li><li><p><strong>Date Extraction</strong> (in priority order):</p><ul><li><strong>Images</strong>:<ul><li>Attempts to read EXIF <code>DateTimeOriginal</code> from top-level tags</li><li>If not found, searches nested EXIF data (ExifIFD) for <code>DateTimeOriginal</code></li><li>Falls back to <code>DateTimeDigitized</code> if <code>DateTimeOriginal</code> is unavailable</li><li>Uses sophisticated multi-level EXIF parsing to handle different camera formats</li></ul></li><li><strong>Videos</strong>: Attempts to read creation date from video metadata (MP4/MOV using mutagen library)</li><li><strong>Fallback</strong>: Uses the older of file creation or modification timestamp</li></ul></li><li><p><strong>Destination Path Generation</strong>:</p><ul><li>If date found: Creates path <code>YYYY/MM_Mmm/</code> (e.g., <code>2024/08_Aug/</code>)</li><li>Filename format: <code>yyyymmdd_hhmmss.ext</code> (without subseconds)</li><li>If no date found: Moves to <code>NoDateFound/</code> folder with original filename</li></ul></li><li><p><strong>Duplicate Check</strong>: Before moving, checks if a file with the same name already exists at the destination</p></li><li><p><strong>File Movement</strong>: Moves the file to the appropriate destination folder</p></li></ol><h3 id=date-extraction-methods>Date Extraction Methods
<a href=#date-extraction-methods class=anchor>#</a></h3><h4 id=exif-metadata-images>EXIF Metadata (Images)
<a href=#exif-metadata-images class=anchor>#</a></h4><p>The application uses a sophisticated multi-level approach to extract date information from EXIF metadata:</p><ol><li><strong>Top-Level Tags</strong>: First attempts to read <code>DateTimeOriginal</code> (tag 306) from top-level EXIF tags</li><li><strong>Nested EXIF Data (ExifIFD)</strong>: If not found at top level, checks nested EXIF data:<ul><li>Accesses ExifIFD (tag 34665 / 0x8769) using Pillow&rsquo;s <code>get_ifd()</code> method (Pillow 8.0+)</li><li>Reads <code>DateTimeOriginal</code> (tag 0x9003 / 36867) from within the ExifIFD</li><li>Falls back to <code>DateTimeDigitized</code> (tag 0x9004) if <code>DateTimeOriginal</code> is unavailable</li><li>Alternative access methods for compatibility with different EXIF structures</li></ul></li><li><strong>Legacy Support</strong>: Supports both modern <code>getexif()</code> and legacy <code>_getexif()</code> Pillow methods for compatibility</li><li><strong>Format</strong>: EXIF date format is <code>YYYY:MM:DD HH:MM:SS</code> (no milliseconds in EXIF standard)</li><li><strong>Sub-Second Precision</strong>: Preserves sub-second precision from file timestamps when EXIF is unavailable</li></ol><p>This multi-level approach ensures maximum compatibility with different camera models and image processing software, as many modern cameras store date information in nested EXIF structures (ExifIFD) rather than top-level tags. The application automatically handles both storage methods, ensuring accurate date extraction regardless of how the camera or software stores the metadata.</p><h4 id=video-metadata>Video Metadata
<a href=#video-metadata class=anchor>#</a></h4><ul><li>For MP4/M4V files: Reads creation date from MP4 metadata tags (<code>©day</code> or <code>\xa9day</code>)</li><li>For MOV files: Reads creation date from QuickTime metadata</li><li>Supports ISO 8601 format: <code>YYYY-MM-DD</code> or <code>YYYY-MM-DDTHH:MM:SS</code></li><li>Falls back to file timestamps if metadata unavailable</li></ul><h4 id=file-timestamps>File Timestamps
<a href=#file-timestamps class=anchor>#</a></h4><ul><li>Uses the older of creation time or modification time</li><li>Preserves sub-second precision (microseconds) when available</li><li>Works for both images and videos when metadata is missing</li><li>Provides reliable fallback for files without embedded metadata</li></ul><h2 id=duplicate-handling>Duplicate Handling
<a href=#duplicate-handling class=anchor>#</a></h2><p>The application implements intelligent duplicate detection and handling to prevent storage waste and maintain a clean photo library.</p><h3 id=duplicate-detection-process>Duplicate Detection Process
<a href=#duplicate-detection-process class=anchor>#</a></h3><ol><li><p><strong>Fast Size Check</strong>: First compares file sizes - if different, files are not duplicates (performance optimization)</p></li><li><p><strong>MD5 Hash Comparison</strong>: If sizes match, calculates MD5 hash of both files</p><ul><li>MD5 hash provides cryptographic-level duplicate detection</li><li>Only performed when file sizes match (optimization)</li><li>Ensures 100% accuracy in identifying identical files</li></ul></li><li><p><strong>Content Comparison</strong>: If hashes match, files are identical duplicates</p></li></ol><h3 id=duplicate-handling-strategies>Duplicate Handling Strategies
<a href=#duplicate-handling-strategies class=anchor>#</a></h3><h4 id=exact-duplicates-same-md5-hash>Exact Duplicates (Same MD5 Hash)
<a href=#exact-duplicates-same-md5-hash class=anchor>#</a></h4><p><strong>If <code>DELETE_DUPLICATES = true</code></strong> (default):</p><ul><li>The duplicate file is deleted immediately</li><li>Statistics track bytes deleted</li><li>Synology indexer is updated to remove the file from index</li><li>No storage space wasted on duplicates</li></ul><p><strong>If <code>DELETE_DUPLICATES = false</code></strong>:</p><ul><li>Duplicate is moved to <code>Duplicates/</code> folder</li><li>Filename format: <code>yyyymmdd_hhmmss.ssss.ext</code> (with subseconds if available)</li><li>If subseconds not available: <code>yyyymmdd_hhmmss.0001.ext</code>, <code>yyyymmdd_hhmmss.0002.ext</code>, etc.</li><li>Statistics track bytes moved</li><li>Preserves all files for manual review</li></ul><h4 id=different-content-same-filename-different-hash>Different Content (Same Filename, Different Hash)
<a href=#different-content-same-filename-different-hash class=anchor>#</a></h4><p>When files have the same destination filename but different content:</p><ol><li><strong>Modification Time Comparison</strong>: Compares file modification times</li><li><strong>Keep Older File</strong>: The older (earlier modified) file stays in the destination folder</li><li><strong>Move Newer File</strong>: The newer file is moved to <code>Duplicates/</code> folder with subseconds format</li><li><strong>Duplicate Check in Duplicates Folder</strong>: Before moving, checks if an identical file already exists in Duplicates folder<ul><li>If found: Deletes the current duplicate instead of creating another</li><li>If not found: Moves with unique subseconds/sequential naming</li></ul></li></ol><h3 id=filename-formats>Filename Formats
<a href=#filename-formats class=anchor>#</a></h3><h4 id=destination-folder>Destination Folder
<a href=#destination-folder class=anchor>#</a></h4><ul><li>Format: <code>yyyymmdd_hhmmss.ext</code></li><li>Example: <code>20250214_134757.jpg</code></li><li>No subseconds included (clean, consistent naming)</li><li>Used for existence checks and organization</li></ul><h4 id=duplicates-folder>Duplicates Folder
<a href=#duplicates-folder class=anchor>#</a></h4><ul><li><strong>With subseconds</strong>: <code>yyyymmdd_hhmmss.ssss.ext</code> (e.g., <code>20250214_134757.3519.jpg</code>)<ul><li>Uses actual subseconds from file timestamp when available</li><li>Provides unique identification based on capture time precision</li></ul></li><li><strong>Without subseconds</strong>: <code>yyyymmdd_hhmmss.0001.ext</code>, <code>yyyymmdd_hhmmss.0002.ext</code>, etc.<ul><li>Sequential numbering ensures unique filenames</li><li>Starts from 0001 and increments as needed</li></ul></li></ul><h3 id=duplicate-detection-in-duplicates-folder>Duplicate Detection in Duplicates Folder
<a href=#duplicate-detection-in-duplicates-folder class=anchor>#</a></h3><p>Before moving a file to the Duplicates folder, the system:</p><ol><li>Calculates MD5 hash of the file to be moved</li><li>Scans all files in the Duplicates folder</li><li>Compares hashes to find exact matches</li><li>If duplicate found: Deletes the file instead of moving it</li><li>Prevents accumulation of multiple identical duplicates</li><li>Ensures Duplicates folder only contains unique files</li></ol><h2 id=statistics-tracking>Statistics Tracking
<a href=#statistics-tracking class=anchor>#</a></h2><p>The application maintains comprehensive statistics about file operations to help users understand the service&rsquo;s activity.</p><h3 id=tracked-metrics>Tracked Metrics
<a href=#tracked-metrics class=anchor>#</a></h3><ul><li><strong>Bytes Moved</strong>: Total size of files successfully organized and moved to destination folders</li><li><strong>Bytes Deleted</strong>: Total size of duplicate files removed from the system</li></ul><h3 id=statistics-logging>Statistics Logging
<a href=#statistics-logging class=anchor>#</a></h3><p>Statistics are automatically logged in the system log when:</p><ol><li><p><strong>Service Stops</strong>: When the service is stopped (graceful shutdown or signal)</p><ul><li>Final statistics are always logged before shutdown</li><li>Prevents loss of statistics data</li></ul></li><li><p><strong>Idle Timeout</strong>: After 1 minute (60 seconds) of no file activity</p><ul><li>Statistics are logged with reason &ldquo;timeout&rdquo; before resetting counters</li><li>Counters reset to zero after logging</li><li>Prevents statistics from growing indefinitely</li><li>Provides periodic activity summaries</li></ul></li><li><p><strong>Manual Reset</strong>: Statistics can be reset programmatically</p></li></ol><h3 id=statistics-format>Statistics Format
<a href=#statistics-format class=anchor>#</a></h3><p>Logged entries appear in <code>System.log</code> with format:</p><pre tabindex=0><code>Info, System, 2025/01/15 14:30:22, PhotoOrganizer, Statistics (service stopped): 2.45 GB moved, 150.30 MB deleted
</code></pre><p>The format includes:</p><ul><li>Log level: <code>Info</code></li><li>Log type: <code>System</code></li><li>Timestamp: <code>YYYY/MM/DD HH:MM:SS</code></li><li>User: System user running the service</li><li>Event: Description with formatted byte counts</li></ul><h3 id=statistics-reset-behavior>Statistics Reset Behavior
<a href=#statistics-reset-behavior class=anchor>#</a></h3><ul><li>Statistics reset automatically after 1 minute of idle time</li><li>Reset prevents counters from accumulating over long periods</li><li>Each reset logs the accumulated statistics before clearing</li><li>Service stop always logs final statistics (even if recently reset)</li><li>Prevents duplicate logging on exit through flag management</li></ul><h3 id=performance-considerations>Performance Considerations
<a href=#performance-considerations class=anchor>#</a></h3><ul><li>Statistics are tracked in memory (global variables)</li><li>Minimal performance impact on file operations</li><li>Logging is asynchronous and doesn&rsquo;t block file processing</li><li>Byte counters use efficient integer arithmetic</li></ul><h2 id=logging>Logging
<a href=#logging class=anchor>#</a></h2><p>Photo Organizer includes comprehensive logging capabilities to track all operations, system events, and file activities. The logging system uses multiple methods to ensure reliability and compatibility with Synology DSM.</p><h3 id=log-files>Log Files
<a href=#log-files class=anchor>#</a></h3><p>The application maintains two primary log files in the destination directory:</p><ol><li><p><strong><code>Photo_Organizer.log</code></strong> - Detailed file operation log</p><ul><li>Tracks all file operations (moves, deletes, duplicates)</li><li>Records file detection events</li><li>Includes file size, timestamps, IP addresses, and user information</li><li>Format: <code>Log, Time, IP address, User, Event, File/Folder, File size, File name, Additional Info</code></li></ul></li><li><p><strong><code>System.log</code></strong> - System events log</p><ul><li>Records service start/stop events</li><li>Logs dependency checks and system status</li><li>Tracks statistics (bytes moved/deleted)</li><li>Format: <code>Level, Log, Time, User, Event</code></li><li>Log levels: Info, Warning, Error</li></ul></li></ol><h3 id=logging-methods>Logging Methods
<a href=#logging-methods class=anchor>#</a></h3><p>The application uses multiple logging methods for maximum reliability:</p><ol><li><p><strong>System Logger</strong> (<code>logger</code> command)</p><ul><li>Integrates with Synology&rsquo;s system logging infrastructure</li><li>Messages are accessible through DSM&rsquo;s Log Center</li><li>Tag: <code>PhotoOrganizer</code></li><li>Priority: <code>user.info</code></li></ul></li><li><p><strong>Synology Logging</strong> (<code>synologset1</code>)</p><ul><li>Synology-specific logging method</li><li>Provides additional integration with DSM logging system</li><li>Used as a fallback if standard logger is unavailable</li></ul></li><li><p><strong>Package Log Files</strong></p><ul><li>Plain text log files stored in the destination directory</li><li>Always accessible to the package user</li><li>Provides detailed operation history</li><li>Can be viewed with any text editor or log viewer</li></ul></li></ol><h3 id=logged-events>Logged Events
<a href=#logged-events class=anchor>#</a></h3><p>The following events are logged:</p><h4 id=file-operations>File Operations
<a href=#file-operations class=anchor>#</a></h4><ul><li><strong>File Detected</strong>: New file detected in source directory</li><li><strong>File Moved</strong>: File successfully moved to destination</li><li><strong>Duplicate Deleted</strong>: Exact duplicate removed</li><li><strong>Moved to Duplicates</strong>: Duplicate file moved to Duplicates folder</li><li><strong>Error</strong>: Any error during file processing</li></ul><h4 id=system-events>System Events
<a href=#system-events class=anchor>#</a></h4><ul><li><strong>Service Started</strong>: Application initialization</li><li><strong>Service Stopped</strong>: Application shutdown</li><li><strong>Dependency Check</strong>: Verification of required Python packages</li><li><strong>Statistics</strong>: Summary of bytes moved and deleted (logged on service stop or idle timeout)</li></ul><h3 id=log-file-locations>Log File Locations
<a href=#log-file-locations class=anchor>#</a></h3><p>On Synology NAS, log files are stored in:</p><ul><li>Default location: <code>/volume1/photo/Photo_Organizer.log</code> and <code>/volume1/photo/System.log</code></li><li>Alternative: Configured destination directory</li></ul><h3 id=viewing-logs>Viewing Logs
<a href=#viewing-logs class=anchor>#</a></h3><h4 id=via-file-station-or-ssh>Via File Station or SSH
<a href=#via-file-station-or-ssh class=anchor>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># View recent file operations</span>
</span></span><span style=display:flex><span>tail -n <span style=color:#ae81ff>50</span> /volume1/photo/Photo_Organizer.log
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># View system events</span>
</span></span><span style=display:flex><span>tail -n <span style=color:#ae81ff>50</span> /volume1/photo/System.log
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># View all logs</span>
</span></span><span style=display:flex><span>cat /volume1/photo/Photo_Organizer.log
</span></span></code></pre></div><h4 id=via-dsm-log-center>Via DSM Log Center
<a href=#via-dsm-log-center class=anchor>#</a></h4><p>System-level events logged via <code>logger</code> and <code>synologset1</code> are accessible through:</p><ul><li><strong>DSM Control Panel</strong> → <strong>Log Center</strong> → <strong>System Logs</strong></li><li>Filter by tag: <code>PhotoOrganizer</code></li></ul><h3 id=log-statistics>Log Statistics
<a href=#log-statistics class=anchor>#</a></h3><p>The application tracks and logs statistics including:</p><ul><li>Total bytes moved (files organized)</li><li>Total bytes deleted (duplicates removed)</li><li>Statistics are logged when:<ul><li>Service stops</li><li>Service is idle for extended periods</li><li>Manual statistics reset occurs</li></ul></li></ul><h3 id=log-format-details>Log Format Details
<a href=#log-format-details class=anchor>#</a></h3><h4 id=file-operation-log-format>File Operation Log Format
<a href=#file-operation-log-format class=anchor>#</a></h4><p>Each entry in <code>Photo_Organizer.log</code> contains:</p><ul><li><strong>Log</strong>: Always &ldquo;SMB&rdquo; (for compatibility with Synology file transfer logs)</li><li><strong>Time</strong>: Timestamp in <code>YYYY-MM-DD HH:MM:SS</code> format</li><li><strong>IP address</strong>: Local IP address of the NAS</li><li><strong>User</strong>: System user running the service</li><li><strong>Event</strong>: Type of operation (File moved, Duplicate Deleted, etc.)</li><li><strong>File/Folder</strong>: Full system path to the file</li><li><strong>File size</strong>: Human-readable file size (e.g., &ldquo;2.45 MB&rdquo;)</li><li><strong>File name</strong>: Base filename</li><li><strong>Additional Info</strong>: Contextual information about the operation</li></ul><h4 id=system-log-format>System Log Format
<a href=#system-log-format class=anchor>#</a></h4><p>Each entry in <code>System.log</code> contains:</p><ul><li><strong>Level</strong>: Log level (Info, Warning, Error)</li><li><strong>Log</strong>: Always &ldquo;System&rdquo;</li><li><strong>Time</strong>: Timestamp in <code>YYYY/MM/DD HH:MM:SS</code> format</li><li><strong>User</strong>: System user</li><li><strong>Event</strong>: Description of the system event</li></ul><h3 id=troubleshooting-with-logs>Troubleshooting with Logs
<a href=#troubleshooting-with-logs class=anchor>#</a></h3><p>Logs are essential for troubleshooting issues:</p><ol><li>Check <code>System.log</code> for dependency errors or service start/stop issues</li><li>Review <code>Photo_Organizer.log</code> for file processing errors</li><li>Look for &ldquo;Error&rdquo; entries to identify specific problems</li><li>Verify file paths and permissions from logged file operations</li></ol><p>For detailed debugging instructions, see the <a href=source/PhotoOrganizer/DEBUGGING.md>DEBUGGING.md</a> file in the project repository.</p><h2 id=synology-integration>Synology Integration
<a href=#synology-integration class=anchor>#</a></h2><p>The Photo Organizer is specifically designed to integrate seamlessly with Synology DiskStation Manager (DSM), providing native NAS functionality.</p><h3 id=synology-detection>Synology Detection
<a href=#synology-detection class=anchor>#</a></h3><p>The application automatically detects if it&rsquo;s running on a Synology NAS by checking:</p><ul><li>Presence of <code>/etc/synoinfo.conf</code></li><li>DSM version file at <code>/etc.defaults/VERSION</code></li><li>Standard Synology volume path <code>/volume1</code></li></ul><h3 id=photo-indexer-integration>Photo Indexer Integration
<a href=#photo-indexer-integration class=anchor>#</a></h3><p>The application automatically updates Synology&rsquo;s built-in photo indexer (<code>synoindex</code>) after file operations:</p><h4 id=indexer-update-process>Indexer Update Process
<a href=#indexer-update-process class=anchor>#</a></h4><ol><li><p><strong>File Deletion</strong>: Removes deleted files from the index</p><ul><li>Command: <code>synoindex -D &lt;file_path></code></li><li>Ensures deleted duplicates don&rsquo;t appear in Photo Station</li><li>Keeps index synchronized with actual file system</li></ul></li><li><p><strong>File Movement</strong>: Updates index when files are moved</p><ul><li>Removes old path: <code>synoindex -D &lt;old_path></code></li><li>Adds new path: <code>synoindex -A &lt;new_path></code></li><li>Keeps Photo Station synchronized with file organization</li><li>Ensures photos appear in correct location in Photo Station</li></ul></li><li><p><strong>Error Handling</strong>: Silently handles cases where <code>synoindex</code> is unavailable</p><ul><li>No errors thrown if indexer command fails</li><li>Service continues operating normally</li><li>Timeout protection (5 seconds) prevents hanging</li><li>Graceful degradation on non-Synology systems</li></ul></li></ol><h3 id=path-conversion>Path Conversion
<a href=#path-conversion class=anchor>#</a></h3><p>The application converts user-visible paths to system paths for logging:</p><ul><li>User path: <code>/volume1/photo/Photo Organizer/file.jpg</code></li><li>System path: <code>/var/services/photo/Photo Organizer/file.jpg</code></li><li>Enables compatibility with Synology&rsquo;s Log Center</li><li>Maintains consistency with DSM&rsquo;s internal path structure</li></ul><h3 id=synology-specific-features>Synology-Specific Features
<a href=#synology-specific-features class=anchor>#</a></h3><ul><li><p><strong>Package Installation</strong>: Designed as a Synology <code>.spk</code> package</p><ul><li>Installs through Package Center</li><li>Follows Synology package structure and conventions</li><li>Includes proper service management scripts</li></ul></li><li><p><strong>Service Management</strong>: Integrates with DSM&rsquo;s package service system</p><ul><li>Can be started/stopped via Package Center</li><li>Respects Synology&rsquo;s service lifecycle</li><li>Proper signal handling for graceful shutdown</li></ul></li><li><p><strong>Log Integration</strong>: Logs appear in DSM Log Center</p><ul><li>Uses Synology&rsquo;s logging infrastructure</li><li>Accessible through DSM web interface</li><li>Filterable by tag and priority</li></ul></li><li><p><strong>User Permissions</strong>: Respects Synology user and permission system</p><ul><li>Runs with appropriate package user permissions</li><li>Respects folder access controls</li><li>Integrates with DSM security model</li></ul></li><li><p><strong>Volume Support</strong>: Works with multiple Synology volumes</p><ul><li>Supports <code>/volume1</code>, <code>/volume2</code>, etc.</li><li>Handles volume-specific paths correctly</li><li>Adapts to different storage configurations</li></ul></li></ul><h3 id=configuration-on-synology>Configuration on Synology
<a href=#configuration-on-synology class=anchor>#</a></h3><p>Configuration files are stored in Synology package directories:</p><ul><li>Primary: <code>/var/packages/PhotoOrganizer/config.ini</code></li><li>Alternative: <code>/var/packages/PhotoOrganizer/var/config.ini</code></li><li>Fallback: <code>/volume1/@appstore/PhotoOrganizer/var/config.ini</code></li></ul><p>The application automatically searches these locations in order and uses the first available configuration file.</p><h3 id=benefits-of-synology-integration>Benefits of Synology Integration
<a href=#benefits-of-synology-integration class=anchor>#</a></h3><ul><li><p><strong>Seamless Operation</strong>: Works like native Synology applications</p><ul><li>No special configuration required</li><li>Follows DSM conventions and standards</li><li>Integrates with existing workflows</li></ul></li><li><p><strong>Photo Station Compatibility</strong>: Organized photos appear correctly in Photo Station</p><ul><li>Indexer updates ensure proper recognition</li><li>Maintains metadata and organization</li><li>Supports Photo Station&rsquo;s browsing features</li></ul></li><li><p><strong>System Logging</strong>: Integrates with DSM&rsquo;s centralized logging</p><ul><li>All events visible in Log Center</li><li>Consistent with other Synology services</li><li>Easy troubleshooting and monitoring</li></ul></li><li><p><strong>Service Management</strong>: Can be started/stopped via Package Center</p><ul><li>Standard Synology package interface</li><li>Status monitoring through Package Center</li><li>Automatic startup on boot (if configured)</li></ul></li><li><p><strong>Resource Management</strong>: Respects Synology&rsquo;s resource limits and scheduling</p><ul><li>Works within DSM&rsquo;s resource constraints</li><li>Compatible with other services</li><li>Efficient resource utilization</li></ul></li></ul><h2 id=license>License
<a href=#license class=anchor>#</a></h2><p>Copyright (c) 2025 MORCE.codes</p><p>This package provides automatic photo organization functionality for Synology NAS. The Photo Organizer and Deduplicator application is provided as-is for organizing photos based on EXIF metadata.</p><h2 id=support>Support
<a href=#support class=anchor>#</a></h2><p>For issues, questions, or contributions, please visit the <a href=https://github.com/52454D434F/DSM-Projects target=_blank rel="noopener noreferrer">GitHub repository</a></p><hr><p><strong>Note</strong>: This package is designed specifically for Synology DiskStation Manager (DSM) and requires a Synology NAS running DSM 7.0 or later.</p></main><footer><div class=footer-content><p>Copyright 2025. All rights reserved.</p></div></footer></body></html>